{"version":3,"sources":["util.js","actions.js","Overview.js","Admin.js","Apdu.js","Oath.js","App.js","serviceWorker.js","reducers.js","index.js","logo.png"],"names":["byteToHexString","uint8arr","hexStr","i","length","hex","toString","toUpperCase","hexStringToByte","str","Uint8Array","a","len","push","parseInt","substr","hexStringToString","array","TextDecoder","decode","sleep","ms","Promise","resolve","setTimeout","TYPES","SET_DEVICE","Symbol","APPEND_APDU_LOG","SET_ADMIN_AUTHENTICATED","setDevice","device","type","connect","dispatch","navigator","usb","requestDevice","filters","classCode","undefined","open","claimInterface","setAdminAuthenticated","state","adminAuthenticated","appendAPDULog","capdu","rapdu","transceive_webusb","data","controlTransferOut","requestType","recipient","request","value","index","resp","controlTransferIn","buffer","status","transceive","is_secret","getState","res","console","log","useStyles","makeStyles","theme","root","flexGrow","paddingLeft","paddingRight","paddingTop","Overview","classes","useSelector","useDispatch","useState","version","setVersion","history","useHistory","useEffect","endsWith","substring","className","Card","CardContent","Typography","variant","manufacturerName","productName","serialNumber","usbVersionMajor","usbVersionMinor","CardActions","Button","onClick","card","marginLeft","marginRight","marginTop","buttonGroup","authenticated","pinDialogOpen","setPinDialogOpen","pin","setPin","flashSpace","setFlashSpace","enqueueSnackbar","useSnackbar","onAuthenticate","useCallback","selectAdminApplet","adminTransceive","success_msg","failed_msg","secret","doAuthenticate","TextEncoder","encode","startsWith","retry","free","total","onKeyPress","e","key","setLedOn","setLedOff","setHotpOn","setHotpOff","resetOpenPGP","resetPIV","resetOATH","enterDFU","ButtonGroup","Dialog","onClose","DialogTitle","DialogContent","DialogContentText","TextField","autoFocus","fullWidth","onChange","target","DialogActions","color","grid","Apdu","apdu","setApdu","setResp","apduHistory","apduLog","apduArray","half","halfByte","num","error","errorMsg","cla","ins","p1","p2","nc","ne","slice","parsedApdu","verifyApdu","sendApdu","replace","Grid","container","spacing","justify","item","xs","placeholder","helperText","Tooltip","title","IconButton","List","map","entry","ListItem","ListItemAvatar","ListItemText","primary","secondary","marginBottom","parseTLV","tlv","tag","Oath","entries","setEntries","addDialogOpen","setAddDialogOpen","name","setName","setKey","keyEncoding","setKeyEncoding","algo","setAlgo","setType","onlyIncreasing","setOnlyIncreasing","requireTouch","setRequireTouch","selectOathApplet","fetchEntries","rawType","rawAlgo","refresh","keyArray","base32","asBytes","err","doAdd","nameArray","flag","property","unshift","doSetDefault","doCalculate","epoch","Math","round","Date","getTime","challenge","floor","padStart","challengeArray","arr","DataView","getUint32","doDelete","importFromClipboard","URL","clipboard","readText","url","protocol","searchParams","get","pathname","TableContainer","component","Paper","Table","TableHead","TableRow","TableCell","TableBody","rowSpan","FormGroup","col","label","FormControl","InputLabel","id","Select","labelId","MenuItem","FormControlLabel","control","Checkbox","checked","icon","paddingBottom","width","nested","App","drawerOpen","setDrawerOpen","appletOpen","setAppletOpen","setCompatible","showOverview","showAdmin","showAPDU","showOATH","AppBar","position","Toolbar","edge","aria-label","Drawer","src","logo","alt","Divider","button","ListItemIcon","Collapse","in","path","exact","Admin","Boolean","window","location","hostname","match","action","close","middleware","thunk","store","createStore","combineReducers","reducers","applyMiddleware","notistackRef","React","createRef","onClickDismiss","current","closeSnackbar","ReactDOM","render","StrictMode","basename","process","maxSnack","ref","document","getElementById","serviceWorker","ready","then","registration","unregister","catch","message","module","exports"],"mappings":"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","file":"static/js/main.384ab22c.chunk.js","sourcesContent":["export function byteToHexString(uint8arr) {\n  if (!uint8arr) return '';\n  var hexStr = '';\n  for (var i = 0; i < uint8arr.length; i++) {\n    var hex = (uint8arr[i] & 0xff).toString(16);\n    hex = (hex.length === 1) ? '0' + hex : hex;\n    hexStr += hex;\n  }\n  return hexStr.toUpperCase();\n}\n\nexport function hexStringToByte(str) {\n  if (!str) return new Uint8Array();\n  var a = [];\n  for (var i = 0, len = str.length; i < len; i += 2)\n    a.push(parseInt(str.substr(i, 2), 16));\n  return new Uint8Array(a);\n}\n\nexport function hexStringToString(str) {\n  let array = hexStringToByte(str);\n  return new TextDecoder(\"utf-8\").decode(array);\n}\n\nexport function sleep(ms) {\n  return new Promise(resolve => setTimeout(resolve, ms));\n}\n","import {byteToHexString, hexStringToByte, sleep} from \"./util\";\n\nexport const TYPES = {\n  SET_DEVICE: Symbol('SET_DEVICE'),\n  APPEND_APDU_LOG: Symbol('APPEND_APDU_LOG'),\n  SET_ADMIN_AUTHENTICATED: Symbol('SET_ADMIN_AUTHENTICATED'),\n}\n\nexport function setDevice(device) {\n  return {\n    type: TYPES.SET_DEVICE,\n    device\n  }\n}\n\nexport function connect() {\n  return async dispatch => {\n    let device = await navigator.usb.requestDevice({\n      filters: [{\n        classCode: 0xFF, // vendor specific\n      }]\n    });\n    if (device !== undefined) {\n      await device.open();\n      await device.claimInterface(1);\n      dispatch(setDevice(device));\n      dispatch(setAdminAuthenticated(false));\n      return true;\n    }\n    return false;\n  };\n}\n\nexport function disconnect() {\n  return {\n    type: TYPES.SET_DEVICE,\n    device: null\n  }\n}\n\nexport function setAdminAuthenticated(state) {\n  return {\n    type: TYPES.SET_ADMIN_AUTHENTICATED,\n    adminAuthenticated: state,\n  }\n}\n\nexport function appendAPDULog(capdu, rapdu) {\n  return {\n    type: TYPES.APPEND_APDU_LOG,\n    capdu: capdu.toUpperCase(),\n    rapdu: rapdu.toUpperCase()\n  }\n}\n\n\nasync function transceive_webusb(device, capdu) {\n  let data = hexStringToByte(capdu);\n\n  // send a command\n  let resp = await device.controlTransferOut({\n    requestType: 'vendor',\n    recipient: 'interface',\n    request: 0,\n    value: 0,\n    index: 1\n  }, data);\n  // wait for execution\n  while (1) {\n    resp = await device.controlTransferIn({\n      requestType: 'vendor',\n      recipient: 'interface',\n      request: 2,\n      value: 0,\n      index: 1\n    }, 1);\n    if (new Uint8Array(resp.data.buffer)[0] === 0) break;\n    await sleep(100);\n  }\n  // get the response\n  resp = await device.controlTransferIn({\n    requestType: 'vendor',\n    recipient: 'interface',\n    request: 1,\n    value: 0,\n    index: 1\n  }, 1500);\n  if (resp.status === \"ok\")\n    return byteToHexString(new Uint8Array(resp.data.buffer));\n  return '';\n}\n\nexport function transceive(capdu, is_secret) {\n  return async (dispatch, getState) => {\n    const {device} = getState();\n    try {\n      let res = await transceive_webusb(device, capdu);\n      if (is_secret) {\n        dispatch(appendAPDULog('REDACTED', res));\n      } else {\n        dispatch(appendAPDULog(capdu, res));\n      }\n      return res;\n    } catch (err) {\n      console.log(err);\n    }\n    return '';\n  };\n}\n","import React, {useEffect, useState} from 'react';\nimport {useDispatch, useSelector} from 'react-redux';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {transceive} from './actions';\nimport {useHistory} from 'react-router-dom';\nimport Typography from \"@material-ui/core/Typography\";\nimport {hexStringToString} from \"./util\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport Button from \"@material-ui/core/Button\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n    paddingLeft: \"10%\",\n    paddingRight: \"10%\",\n    paddingTop: \"50px\",\n  },\n}));\n\nexport default function Overview() {\n  const classes = useStyles();\n  const device = useSelector(state => state.device);\n  const dispatch = useDispatch();\n  const [version, setVersion] = useState(\"Unknown\");\n  const history = useHistory();\n\n  useEffect(() => {\n    (async () => {\n      if (device !== null) {\n        let res = await dispatch(transceive(\"00A4040005F000000000\"));\n        if (!res.endsWith(\"9000\")) {\n          return;\n        }\n        res = await dispatch(transceive(\"0031000000\"));\n        if (res.endsWith(\"9000\")) {\n          let version = hexStringToString(res.substring(0, res.length - 4));\n          setVersion(version);\n        }\n      } else {\n        console.log('device is not open');\n      }\n    })();\n  }, [device, dispatch]);\n\n  return (\n    <div className={classes.root}>\n      <Card>\n        <CardContent>\n          <Typography variant=\"h2\">\n            Canokey Info\n          </Typography>\n          <Typography>\n            Connected: {device !== null ? 'true' : 'false'}\n          </Typography>\n          <Typography>\n            Firmware Version: {version}\n          </Typography>\n          <Typography>\n            Manufacturer: {device !== null ? device.manufacturerName : 'Unknown'}\n          </Typography>\n          <Typography>\n            Product: {device !== null ? device.productName : 'Unknown'}\n          </Typography>\n          <Typography>\n            Serial Number: {device !== null ? device.serialNumber : 'Unknown'}\n          </Typography>\n          <Typography>\n            USB Version: {device !== null ? `${device.usbVersionMajor}.${device.usbVersionMinor}` : 'Unknown'}\n          </Typography>\n        </CardContent>\n        <CardActions>\n          <Button onClick={() => history.push('/admin')}>Admin</Button>\n          <Button onClick={() => history.push('/oath')}>OATH</Button>\n          <Button>OpenPGP</Button>\n          <Button>PIV</Button>\n        </CardActions>\n      </Card>\n    </div>\n  );\n}\n","import React, {useCallback, useState} from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport {connect, setAdminAuthenticated, transceive} from \"./actions\";\nimport {byteToHexString} from \"./util\";\nimport {useSnackbar} from \"notistack\";\nimport ButtonGroup from \"@material-ui/core/ButtonGroup\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  card: {\n    marginLeft: \"10%\",\n    marginRight: \"10%\",\n    marginTop: \"30px\",\n  },\n  buttonGroup: {\n    marginLeft: \"20px\"\n  }\n}));\n\n/* eslint-disable no-throw-literal */\nexport default function Overview() {\n  const classes = useStyles();\n  const device = useSelector(state => state.device);\n  const dispatch = useDispatch();\n  const authenticated = useSelector(state => state.adminAuthenticated);\n  const [pinDialogOpen, setPinDialogOpen] = useState(false);\n  const [pin, setPin] = useState('');\n  const [flashSpace, setFlashSpace] = useState('unknown');\n  const {enqueueSnackbar} = useSnackbar();\n\n  const onAuthenticate = useCallback(() => {\n    setPinDialogOpen(true);\n  }, []);\n\n\n  const selectAdminApplet = useCallback(async () => {\n    if (device === null) {\n      if (!await dispatch(connect())) {\n        throw 'Cannot connect to Canokey';\n      }\n    }\n\n    let res = await dispatch(transceive(\"00A4040005F000000000\"));\n    if (!res.endsWith(\"9000\")) {\n      throw 'Selecting admin applet failed';\n    }\n  }, [device, dispatch]);\n\n  const adminTransceive = useCallback(async (capdu, success_msg, failed_msg, secret) => {\n    try {\n      await selectAdminApplet();\n      let res = await dispatch(transceive(capdu, secret));\n      if (res.endsWith(\"9000\")) {\n        enqueueSnackbar(success_msg, {variant: 'success'});\n        return true;\n      } else {\n        enqueueSnackbar(failed_msg, {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n    return false;\n  }, [dispatch, selectAdminApplet, enqueueSnackbar]);\n\n  const doAuthenticate = useCallback(async () => {\n    setPinDialogOpen(false);\n    try {\n      let array = new TextEncoder().encode(pin);\n      let len = new Uint8Array([array.length]);\n      await selectAdminApplet();\n      let res = await dispatch(transceive(`00200000${byteToHexString(len)}${byteToHexString(array)}`, true));\n      if (res.startsWith(\"63C\")) {\n        let retry = parseInt(res.substr(3, 1), 16);\n        enqueueSnackbar(`PIN verification failed, ${retry} retires left`, {variant: 'error'});\n      } else if (res.endsWith(\"9000\")) {\n        dispatch(setAdminAuthenticated(true));\n        enqueueSnackbar('PIN verification success', {variant: 'success'});\n        res = await dispatch(transceive(\"0041000000\"));\n        if (res.endsWith(\"9000\")) {\n          let free = parseInt(res.substring(0, 2), 16);\n          let total = parseInt(res.substring(2, 4), 16);\n          setFlashSpace(`free: ${free} KiB, total ${total} KiB`);\n        }\n      } else {\n        enqueueSnackbar('PIN verification failed', {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [pin, dispatch, enqueueSnackbar, selectAdminApplet]);\n\n  const onKeyPress = useCallback(async (e) => {\n    if (e.key === 'Enter') {\n      await doAuthenticate();\n    }\n  }, [doAuthenticate]);\n\n  const setLedOn = useCallback(async () => {\n    await adminTransceive(\"00400101\", \"LED is on\", \"Set LED status failed\");\n  }, [adminTransceive]);\n\n  const setLedOff = useCallback(async () => {\n    await adminTransceive(\"00400100\", \"LED is off\", \"Set LED status failed\");\n  }, [adminTransceive]);\n\n  const setHotpOn = useCallback(async () => {\n    await adminTransceive(\"00400301\", \"HOTP on touch is on\", \"Set HOTP status failed\");\n  }, [adminTransceive]);\n\n  const setHotpOff = useCallback(async () => {\n    await adminTransceive(\"00400300\", \"HOTP on touch is off\", \"Set HOTP status failed\");\n  }, [adminTransceive]);\n\n  const resetOpenPGP = useCallback(async () => {\n    await adminTransceive(\"00030000\", \"Reset OpenPGP done\", \"Reset OpenPGP failed\");\n  }, [adminTransceive]);\n\n  const resetPIV = useCallback(async () => {\n    await adminTransceive(\"00040000\", \"Reset PIV done\", \"Reset PIV failed\");\n  }, [adminTransceive]);\n\n  const resetOATH = useCallback(async () => {\n    await adminTransceive(\"00050000\", \"Reset OATH done\", \"Reset OATH failed\");\n  }, [adminTransceive]);\n\n  const enterDFU = useCallback(async () => {\n    await adminTransceive(\"00FF2222\", \"Enter DFU: Unexpected success\",\n      \"Enter DFU: WebUSB disconnected, device should be in DFU now\");\n  }, [adminTransceive]);\n\n  return (\n    <div className={classes.root}>\n      <Card className={classes.card}>\n        <CardContent>\n          <Typography variant=\"h3\">\n            Admin Applet\n          </Typography>\n          <Typography>\n            Authenticated: {authenticated ? 'true' : 'false'}\n          </Typography>\n          <Typography>\n            Flash space info: {flashSpace}\n          </Typography>\n        </CardContent>\n        <CardActions>\n          <Button onClick={onAuthenticate} variant=\"contained\">\n            Authenticate\n          </Button>\n        </CardActions>\n      </Card>\n      {\n        authenticated ?\n          <div>\n            <Card className={classes.card}>\n              <CardContent>\n                <Typography variant=\"h3\">\n                  Config\n                </Typography>\n                <Typography variant=\"h6\">\n                  LED:\n                  <ButtonGroup variant=\"contained\" className={classes.buttonGroup}>\n                    <Button onClick={setLedOn}>ON</Button>\n                    <Button onClick={setLedOff}>OFF</Button>\n                  </ButtonGroup>\n                </Typography>\n                <Typography variant=\"h6\">\n                  HOTP on touch:\n                  <ButtonGroup variant=\"contained\" className={classes.buttonGroup}>\n                    <Button onClick={setHotpOn}>ON</Button>\n                    <Button onClick={setHotpOff}>OFF</Button>\n                  </ButtonGroup>\n                </Typography>\n              </CardContent>\n              <CardActions>\n                <Button variant=\"contained\" onClick={enterDFU}>Enter DFU (development only)</Button>\n              </CardActions>\n            </Card>\n            <Card className={classes.card}>\n              <CardContent>\n                <Typography variant=\"h3\">\n                  Reset Applet\n                </Typography>\n              </CardContent>\n              <CardActions>\n                <Button onClick={resetOpenPGP} variant=\"contained\">Reset OpenPGP</Button>\n                <Button onClick={resetPIV} variant=\"contained\">Reset PIV</Button>\n                <Button onClick={resetOATH} variant=\"contained\">Reset OATH</Button>\n              </CardActions>\n            </Card>\n          </div>\n          : null\n      }\n      <Dialog open={pinDialogOpen} onClose={() => setPinDialogOpen(false)}>\n        <DialogTitle> Enter PIN to Authenticate Admin Applet</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            Enter PIN below. Please be aware of PIN retry count. This will not be stored in browser.\n          </DialogContentText>\n          <TextField\n            type=\"password\"\n            autoFocus\n            fullWidth\n            onKeyPress={onKeyPress}\n            onChange={(e) => setPin(e.target.value)}/>\n        </DialogContent>\n        <DialogActions>\n          <Button color=\"primary\" onClick={doAuthenticate}>\n            Authenticate\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, {useCallback, useState} from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport TextField from \"@material-ui/core/TextField\";\nimport Grid from \"@material-ui/core/Grid\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport {connect, transceive} from \"./actions\";\nimport {useSnackbar} from \"notistack\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport SyncAltIcon from '@material-ui/icons/SyncAlt';\nimport SendIcon from \"@material-ui/icons/Send\";\nimport {byteToHexString} from \"./util\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport IconButton from \"@material-ui/core/IconButton\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  grid: {\n    marginLeft: '10%',\n    marginRight: '10%',\n  }\n}));\n\nfunction verifyApdu(capdu) {\n  let apduArray = [];\n  let half = false;\n  let halfByte = 0;\n  for (let i = 0; i < capdu.length; i += 1) {\n    // skip spaces\n    if (capdu.substr(i, 1) === ' ') {\n      continue;\n    }\n    let num = parseInt(capdu.substr(i, 1), 16);\n    if (0 <= num && num < 16) {\n      if (half) {\n        apduArray.push((halfByte * 16) + num);\n        half = false;\n      } else {\n        halfByte = num;\n        half = true\n      }\n    } else {\n      return {\n        error: true,\n        errorMsg: `invalid hex: ${capdu.substr(i, 1)}`\n      }\n    }\n  }\n  if (half) {\n    return {\n      error: true,\n      errorMsg: 'invalid hex string'\n    }\n  }\n\n  if (apduArray.length < 4) {\n    return {\n      error: true,\n      errorMsg: 'apdu should have at least four bytes long'\n    }\n  }\n\n  let cla = apduArray[0];\n  let ins = apduArray[1];\n  let p1 = apduArray[2];\n  let p2 = apduArray[3];\n  let nc = 0;\n  let ne = 0;\n  let data = null;\n\n  if (apduArray.length === 4) {\n    // no lc or le\n  } else if (apduArray.length === 5) {\n    // case 2s\n    // only one byte le\n    ne = apduArray[4];\n    if (ne === 0) {\n      ne = 255;\n    }\n  } else if (apduArray[4] > 0 && apduArray.length === 5 + apduArray[4]) {\n    // case 3s\n    // only one byte lc\n    nc = apduArray[4];\n    data = apduArray.slice(5);\n    ne = 0;\n  } else if (apduArray[4] > 0 && apduArray.length === 6 + apduArray[4]) {\n    // case 4s\n    // one byte lc + one byte le\n    nc = apduArray[4];\n    data = apduArray.slice(5, 5 + nc);\n    ne = apduArray[5 + nc];\n    if (ne === 0) {\n      ne = 255;\n    }\n  } else if (apduArray.length === 7) {\n    // case 2e\n    // only three bytes of le, first of which is zero\n    if (apduArray[4] !== 0) {\n      return {\n        error: true,\n        errorMsg: 'the first byte of three-byte le field cannot be non-zero'\n      };\n    }\n    ne = apduArray[5] * 256 + apduArray[6];\n  } else {\n    // case 3e & r3\n    // three bytes of lc\n    if (apduArray[4] !== 0) {\n      return {\n        error: true,\n        errorMsg: 'the first byte of three-byte lc field cannot be non-zero'\n      };\n    }\n    nc = apduArray[5] * 256 + apduArray[6];\n    if (nc === 0) {\n      return {\n        error: true,\n        errorMsg: 'three-byte lc field cannot be zero'\n      };\n    }\n\n    if (apduArray.length === 7 + nc) {\n      // case 3e\n      // only three bytes of lc\n      data = apduArray.slice(7);\n      ne = 0;\n    } else if (apduArray.length === 9 + nc) {\n      // case 4e\n      // three bytes of lc and two bytes of le\n      data = apduArray.slice(7, 7 + nc);\n      ne = apduArray[7 + nc] * 256 + apduArray[8 + nc];\n      if (ne === 0) {\n        ne = 0x10000;\n      }\n    } else {\n      return {\n        error: true,\n        errorMsg: 'not in any possible case of apdu'\n      };\n    }\n  }\n\n  return {\n    parsedApdu: {\n      cla,\n      ins,\n      p1,\n      p2,\n      nc,\n      ne,\n      data\n    },\n  }\n\n}\n\n/* eslint-disable no-throw-literal */\nexport default function Apdu() {\n  const classes = useStyles();\n  const device = useSelector(state => state.device);\n  const dispatch = useDispatch();\n  const [apdu, setApdu] = useState('');\n  const [resp, setResp] = useState('');\n  const {enqueueSnackbar} = useSnackbar();\n  const apduHistory = useSelector(state => state.apduLog);\n\n  let {parsedApdu, error, errorMsg} = verifyApdu(apdu);\n\n  const sendApdu = useCallback(async () => {\n    try {\n      if (device === null) {\n        if (!await dispatch(connect())) {\n          throw 'Cannot connect to Canokey';\n        }\n      }\n\n      let capdu = apdu.replace(/\\s/g, '');\n      setResp(await dispatch(transceive(capdu)));\n      enqueueSnackbar('Command APDU sent', {variant: 'success'});\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [device, apdu, dispatch, enqueueSnackbar]);\n\n  return (\n    <div className={classes.root}>\n      <Grid container spacing={1} justify={\"center\"}>\n        <Grid item xs={5}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h4\">\n                Send Command APDU\n              </Typography>\n              <TextField\n                autoFocus\n                fullWidth\n                placeholder=\"Input APDU here\"\n                error={error}\n                helperText={errorMsg}\n                onChange={(e) => setApdu(e.target.value)}/>\n              {\n                parsedApdu ?\n                  <div>\n                    <Typography>\n                      CLA: {byteToHexString([parsedApdu.cla])}\n                    </Typography>\n                    <Typography>\n                      INS: {byteToHexString([parsedApdu.ins])}\n                    </Typography>\n                    <Typography>\n                      P1: {byteToHexString([parsedApdu.p1])}\n                    </Typography>\n                    <Typography>\n                      P2: {byteToHexString([parsedApdu.p2])}\n                    </Typography>\n                    {\n                      parsedApdu.data ?\n                        <Typography>\n                          Command Data: {byteToHexString(parsedApdu.data)}\n                        </Typography> : null\n                    }\n                    <Typography>\n                      N<sub>e</sub> (Maximum response bytes): {parsedApdu.ne.toString(16)}\n                    </Typography>\n                  </div> : null\n              }\n              {\n                resp ?\n                  <Typography>\n                    Resp: {resp}\n                  </Typography> : null\n              }\n            </CardContent>\n            <CardActions>\n              <Tooltip title=\"Send APDU\">\n                <IconButton onClick={sendApdu}>\n                  <SendIcon/>\n                </IconButton>\n              </Tooltip>\n            </CardActions>\n          </Card>\n        </Grid>\n        <Grid item xs={5}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h4\">\n                APDU History\n              </Typography>\n              <Typography>\n                From earliest to latest\n              </Typography>\n              <List>\n                {\n                  apduHistory.map((entry) => {\n                    return <ListItem key={entry}>\n                      <ListItemAvatar>\n                        <SyncAltIcon/>\n                      </ListItemAvatar>\n                      <ListItemText primary={`Command: ${entry.capdu}`} secondary={`Response: ${entry.rapdu}`}/>\n                    </ListItem>;\n                  })\n                }\n              </List>\n            </CardContent>\n          </Card>\n        </Grid>\n      </Grid>\n    </div>\n  );\n}\n","import React, {useCallback, useEffect, useState} from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport Grid from \"@material-ui/core/Grid\";\nimport {useSnackbar} from \"notistack\";\nimport {connect, transceive} from \"./actions\";\nimport {byteToHexString, hexStringToByte} from \"./util\";\nimport Card from \"@material-ui/core/Card\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport TableContainer from \"@material-ui/core/TableContainer\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Table from \"@material-ui/core/Table\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport Button from \"@material-ui/core/Button\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport DialogContentText from \"@material-ui/core/DialogContentText\";\nimport TextField from \"@material-ui/core/TextField\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport Select from \"@material-ui/core/Select\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport FormGroup from \"@material-ui/core/FormGroup\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Tooltip from \"@material-ui/core/Tooltip\";\nimport StarIcon from \"@material-ui/icons/Star\";\nimport DeleteForeverIcon from \"@material-ui/icons/DeleteForever\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport AvTimerIcon from \"@material-ui/icons/AvTimer\";\nimport * as base32 from \"hi-base32\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  grid: {\n    marginTop: '30px',\n    marginBottom: '30px',\n  }\n}));\n\n/* eslint-disable no-throw-literal */\nfunction parseTLV(tlv) {\n  let res = [];\n  for (let i = 0; i < tlv.length;) {\n    if (i + 1 >= tlv.length) {\n      throw 'Bad TLV';\n    }\n    let tag = tlv[i];\n    let len = tlv[i + 1];\n    if (i + 1 + len >= tlv.length) {\n      throw 'Bad TLV Length'\n    }\n    let value = tlv.slice(i + 2, i + 2 + len);\n    i += len + 2;\n    res.push({\n      tag,\n      len,\n      value\n    })\n  }\n  return res;\n}\n\nexport default function Oath() {\n  const classes = useStyles();\n  const device = useSelector(state => state.device);\n  const dispatch = useDispatch();\n  const {enqueueSnackbar} = useSnackbar();\n  const [entries, setEntries] = useState([]);\n\n  // add\n  const [addDialogOpen, setAddDialogOpen] = useState(false);\n  const [name, setName] = useState('');\n  const [key, setKey] = useState('');\n  const [keyEncoding, setKeyEncoding] = useState('UTF-8');\n  const [algo, setAlgo] = useState('HMAC-SHA1');\n  const [type, setType] = useState('HOTP');\n  const [onlyIncreasing, setOnlyIncreasing] = useState(false);\n  const [requireTouch, setRequireTouch] = useState(false);\n\n  const selectOathApplet = useCallback(async () => {\n    if (device === null) {\n      if (!await dispatch(connect())) {\n        throw 'Cannot connect to Canokey';\n      }\n    }\n\n    let res = await dispatch(transceive(\"00A4040007A0000005272101\"));\n    if (!res.endsWith(\"9000\")) {\n      throw 'Selecting oath applet failed';\n    }\n  }, [device, dispatch]);\n\n  const fetchEntries = useCallback(async () => {\n    await selectOathApplet();\n    let res = await dispatch(transceive(\"0003000000\"));\n    if (!res.endsWith(\"9000\")) {\n      throw 'Failed to list OATH credentials';\n    }\n    let tlv = parseTLV(hexStringToByte(res.substring(0, res.length - 4)));\n    if (tlv.length % 2 === 1) {\n      throw 'Invalid length of TLV';\n    }\n    let entries = [];\n    for (let i = 0; i < tlv.length; i += 2) {\n      if (tlv[i].tag !== 0x71 || tlv[i + 1].tag !== 0x75) {\n        throw 'Bad tag in tlv'\n      }\n\n      let rawType = tlv[i + 1].value[0] >> 4;\n      let type = 'unknown';\n      if (rawType === 0x1) {\n        type = 'HOTP';\n      } else if (rawType === 0x2) {\n        type = 'TOTP';\n      }\n\n      let rawAlgo = tlv[i + 1].value[0] & 0xF;\n      let algo = 'unknown';\n      if (rawAlgo === 0x1) {\n        algo = 'HMAC-SHA1';\n      } else if (rawAlgo === 0x2) {\n        algo = 'HMAC-SHA256';\n      }\n\n      entries.push({\n        name: new TextDecoder(\"utf-8\").decode(tlv[i].value),\n        type,\n        algo,\n      })\n    }\n    setEntries(entries);\n  }, [dispatch, selectOathApplet]);\n\n  const refresh = useCallback(async () => {\n    try {\n      if (device !== null) {\n        await fetchEntries();\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [device, fetchEntries, enqueueSnackbar]);\n\n  useEffect(() => {\n    (async () => {\n      await refresh();\n    })();\n  }, [refresh]);\n\n  let keyArray = [];\n  try {\n    if (keyEncoding === 'UTF-8') {\n      keyArray = new TextEncoder().encode(key);\n    } else if (keyEncoding === 'HEX') {\n      keyArray = hexStringToByte(key);\n    } else if (keyEncoding === 'Base32') {\n      keyArray = base32.decode.asBytes(key);\n    } else {\n      throw \"Unsupported key encoding\";\n    }\n  } catch (err) {\n    enqueueSnackbar(err.toString(), {variant: 'error'});\n  }\n\n\n  const doAdd = useCallback(async () => {\n    setAddDialogOpen(false);\n    try {\n      await selectOathApplet();\n      let data = [];\n      // name\n      data.push(0x71);\n      let nameArray = new TextEncoder().encode(name);\n      data.push(nameArray.length);\n      data.push(...nameArray);\n      // key\n      data.push(0x73);\n      data.push(keyArray.length + 2);\n      let flag = 0;\n      if (type === 'HOTP') {\n        flag += 0x10;\n      } else if (type === 'TOTP') {\n        flag += 0x20;\n      } else {\n        throw 'invalid type';\n      }\n      if (algo === 'HMAC-SHA1') {\n        flag += 0x01;\n      } else if (algo === 'HMAC-SHA256') {\n        flag += 0x02;\n      } else {\n        throw 'invalid algorithm';\n      }\n      data.push(flag);\n      data.push(6); // 6 digits\n      data.push(...keyArray);\n\n      // property\n      data.push(0x78);\n      data.push(1);\n      let property = 0;\n      if (onlyIncreasing) {\n        property += 0x1;\n      }\n      if (requireTouch) {\n        property += 0x2;\n      }\n      data.push(property);\n\n      // lc\n      data.unshift(data.length);\n\n      let res = await dispatch(transceive(`00010000${byteToHexString(data)}`));\n      if (res.endsWith(\"9000\")) {\n        enqueueSnackbar('Add OATH credential success', {variant: 'success'});\n      } else {\n        enqueueSnackbar('Add OATH credential failed', {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n    await refresh();\n  }, [refresh, dispatch, name, algo, enqueueSnackbar, onlyIncreasing, requireTouch, selectOathApplet, type, keyArray]);\n\n  const doSetDefault = useCallback(async (name) => {\n    try {\n      await selectOathApplet();\n      let data = [];\n      // name\n      data.push(0x71);\n      let nameArray = new TextEncoder().encode(name);\n      data.push(nameArray.length);\n      data.push(...nameArray);\n      // lc\n      data.unshift(data.length);\n\n      let res = await dispatch(transceive(`00550000${byteToHexString(data)}`));\n      if (res.endsWith(\"9000\")) {\n        enqueueSnackbar('Set OATH credential as default success', {variant: 'success'});\n      } else {\n        enqueueSnackbar('Set OATH credential as default failed', {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [dispatch, enqueueSnackbar, selectOathApplet]);\n\n  const doCalculate = useCallback(async (name) => {\n    try {\n      await selectOathApplet();\n      let data = [];\n      // name\n      data.push(0x71);\n      let nameArray = new TextEncoder().encode(name);\n      data.push(nameArray.length);\n      data.push(...nameArray);\n      // challenge\n      data.push(0x74);\n      let epoch = Math.round(new Date().getTime() / 1000.0);\n      let challenge = Math.floor(epoch / 30.0); // 30s\n      // 64bit\n      let str = challenge.toString(16).padStart(16, '0');\n      let challengeArray = hexStringToByte(str);\n      data.push(challengeArray.length);\n      data.push(...challengeArray);\n      // lc\n      data.unshift(data.length);\n\n      let res = await dispatch(transceive(`00040000${byteToHexString(data)}`));\n      if (res.endsWith(\"9000\")) {\n        // 32bit integer\n        let arr = hexStringToByte(res.substr(6, 8));\n        let num = new DataView(arr.buffer).getUint32(0, false) % 1000000;\n        enqueueSnackbar(`TOTP code is ${num.toString().padStart(6, '0')}`, {variant: 'success'});\n      } else {\n        enqueueSnackbar('Calculate TOTP failed', {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [dispatch, enqueueSnackbar, selectOathApplet]);\n\n  const doDelete = useCallback(async (name) => {\n    try {\n      await selectOathApplet();\n      let data = [];\n      // name\n      data.push(0x71);\n      let nameArray = new TextEncoder().encode(name);\n      data.push(nameArray.length);\n      data.push(...nameArray);\n      // lc\n      data.unshift(data.length);\n\n      let res = await dispatch(transceive(`00020000${byteToHexString(data)}`));\n      if (res.endsWith(\"9000\")) {\n        enqueueSnackbar('Delete OATH credential success', {variant: 'success'});\n      } else {\n        enqueueSnackbar('Delete OATH credential failed', {variant: 'error'});\n      }\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n    await refresh();\n  }, [refresh, dispatch, enqueueSnackbar, selectOathApplet]);\n\n  const importFromClipboard = useCallback(async () => {\n    try {\n      let url = new URL(await navigator.clipboard.readText());\n      if (url.protocol !== 'otpauth:') {\n        throw 'Clipboard text is not a otpauth link';\n      }\n\n      if (url.searchParams.get(\"algorithm\") === 'SHA1') {\n        setAlgo(\"HMAC-SHA1\");\n      } else if (url.searchParams.get(\"algorithm\") === 'SHA256') {\n        setAlgo(\"HMAC-SHA256\");\n      } else if (url.searchParams.get(\"algorithm\") !== null) {\n        throw 'Unsupported algorithm';\n      }\n\n      if (url.pathname.startsWith(\"//totp\")) {\n        setType(\"TOTP\");\n      } else if (url.pathname.startsWith(\"//hotp\")) {\n        setType(\"HOTP\");\n      } else {\n        throw 'Unsupproted type';\n      }\n      setName(url.pathname.substring(7));\n\n      setKey(url.searchParams.get(\"secret\"));\n      setKeyEncoding(\"Base32\");\n    } catch (err) {\n      enqueueSnackbar(err.toString(), {variant: 'error'});\n    }\n  }, [enqueueSnackbar]);\n\n  return (\n    <div className={classes.root}>\n      <Grid container spacing={1} justify={\"center\"} className={classes.grid}>\n        <Grid item xs={10}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h3\">\n                OATH Applet\n              </Typography>\n              <TableContainer component={Paper}>\n                <Table>\n                  <TableHead>\n                    <TableRow>\n                      <TableCell>\n                        Name\n                      </TableCell>\n                      <TableCell>\n                        Type\n                      </TableCell>\n                      <TableCell>\n                        Algorithm\n                      </TableCell>\n                      <TableCell>\n                        Action\n                      </TableCell>\n                    </TableRow>\n                  </TableHead>\n                  <TableBody>\n                    {entries.map((entry) => (\n                      <TableRow key={entry.name}>\n                        <TableCell>\n                          {entry.name}\n                        </TableCell>\n                        <TableCell>\n                          {entry.type}\n                        </TableCell>\n                        <TableCell>\n                          {entry.algo}\n                        </TableCell>\n                        <TableCell>\n                          {\n                            entry.type === 'HOTP' ?\n                              <Tooltip title=\"Set as default\">\n                                <IconButton onClick={() => doSetDefault(entry.name)}>\n                                  <StarIcon/>\n                                </IconButton>\n                              </Tooltip>\n                              :\n                              <Tooltip title=\"Calculate TOTP\">\n                                <IconButton onClick={() => doCalculate(entry.name)}>\n                                  <AvTimerIcon/>\n                                </IconButton>\n                              </Tooltip>\n                          }\n                          <Tooltip title=\"Delete forever\">\n                            <IconButton onClick={() => doDelete(entry.name)}>\n                              <DeleteForeverIcon/>\n                            </IconButton>\n                          </Tooltip>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                    {entries.length === 0 ?\n                      <TableRow>\n                        <TableCell rowSpan={4}>\n                          {device !== null ? 'No entries' : 'Please connect to device first'}\n                        </TableCell>\n                      </TableRow>\n                      : null\n                    }\n                  </TableBody>\n                </Table>\n              </TableContainer>\n            </CardContent>\n            <CardActions>\n              <Tooltip title=\"Add a new OATH credential\">\n                <IconButton onClick={() => setAddDialogOpen(true)}>\n                  <AddIcon/>\n                </IconButton>\n              </Tooltip>\n            </CardActions>\n          </Card>\n        </Grid>\n      </Grid>\n      <Dialog open={addDialogOpen} onClose={() => setAddDialogOpen(false)}>\n        <DialogTitle>Add credential to OATH Applet</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            Set OATH credential info below\n          </DialogContentText>\n          <FormGroup col>\n            <TextField\n              fullWidth\n              label=\"Name\"\n              value={name}\n              error={name.length === 0}\n              helperText={name.length > 0 ? '' : 'name cannot be empty'}\n              onChange={(e) => setName(e.target.value)}/>\n            <TextField\n              fullWidth\n              label=\"Key\"\n              value={key}\n              onChange={(e) => setKey(e.target.value)}>\n            </TextField>\n            <FormControl>\n              <InputLabel id=\"encoding-label\">Key Encoding</InputLabel>\n              <Select labelId=\"encoding-label\" value={keyEncoding} onChange={(e) => setKeyEncoding(e.target.value)}>\n                <MenuItem value=\"UTF-8\">UTF-8</MenuItem>\n                <MenuItem value=\"HEX\">HEX</MenuItem>\n                <MenuItem value=\"Base32\">Base32</MenuItem>\n              </Select>\n            </FormControl>\n            <FormControl>\n              <InputLabel id=\"algo-label\">Algorithm</InputLabel>\n              <Select labelId=\"algo-label\" value={algo} onChange={(e) => setAlgo(e.target.value)}>\n                <MenuItem value={\"HMAC-SHA1\"}>HMAC-SHA1</MenuItem>\n                <MenuItem value={\"HMAC-SHA256\"}>HMAC-SHA256</MenuItem>\n              </Select>\n            </FormControl>\n            <FormControl>\n              <InputLabel id=\"type-label\">Type</InputLabel>\n              <Select labelId=\"type-label\" value={type} onChange={(e) => setType(e.target.value)}>\n                <MenuItem value={\"HOTP\"}>HOTP</MenuItem>\n                <MenuItem value={\"TOTP\"}>TOTP</MenuItem>\n              </Select>\n            </FormControl>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={onlyIncreasing}\n                  onChange={(e) => setOnlyIncreasing(e.target.checked)}\n                />\n              }\n              label=\"Only increasing\"\n            />\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={requireTouch}\n                  onChange={(e) => setRequireTouch(e.target.checked)}\n                />\n              }\n              label=\"Require touch\"\n            />\n          </FormGroup>\n          <Typography>\n            Key in hex: {byteToHexString(keyArray)}\n          </Typography>\n        </DialogContent>\n        <DialogActions>\n          <Button variant=\"contained\" color=\"secondary\" onClick={importFromClipboard}>\n            Import Otpauth from Clipboard\n          </Button>\n          <Button variant=\"contained\" color=\"primary\" onClick={doAdd}>\n            Add\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  );\n}\n","import React, {useState, useCallback, useEffect} from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport logo from './logo.png';\nimport {\n  Toolbar,\n  AppBar,\n  IconButton,\n  Typography,\n  Drawer,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemText,\n  Divider,\n  Button,\n  Collapse,\n} from '@material-ui/core';\nimport {Route, Switch, useHistory} from 'react-router-dom';\nimport {useSelector, useDispatch} from 'react-redux';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport HomeIcon from '@material-ui/icons/Home';\nimport AppsIcon from '@material-ui/icons/Apps';\nimport ExpandLessIcon from '@material-ui/icons/ExpandLess';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowForwardIcon from '@material-ui/icons/ArrowForward';\nimport SyncAltIcon from '@material-ui/icons/SyncAlt';\nimport {connect, disconnect} from './actions';\nimport Overview from './Overview';\nimport Admin from \"./Admin\";\nimport Apdu from \"./Apdu\";\nimport Oath from \"./Oath\";\nimport {useSnackbar} from \"notistack\";\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    flexGrow: 1,\n  },\n  title: {\n    flexGrow: 1,\n  },\n  icon: {\n    paddingLeft: \"20px\",\n    paddingTop: \"10px\",\n    paddingBottom: \"10px\",\n    width: \"70%\",\n  },\n  nested: {\n    paddingLeft: theme.spacing(5),\n  },\n}));\n\nexport default function App() {\n  const classes = useStyles();\n  const [drawerOpen, setDrawerOpen] = useState(false);\n  const [appletOpen, setAppletOpen] = useState(true);\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const device = useSelector(state => state.device);\n  const [compatible, setCompatible] = useState(true);\n  const {enqueueSnackbar} = useSnackbar();\n\n  useEffect(() => {\n    if (navigator.usb === undefined) {\n      setCompatible(false);\n      enqueueSnackbar('Your browser does not support WebUSB, please use new versions of Chrome/Chromium/Edge/Opera.',\n        {variant: \"error\"});\n    } else {\n      enqueueSnackbar('Your browser supports WebUSB, and you are good to go!',\n        {variant: \"success\"});\n    }\n  }, [enqueueSnackbar]);\n\n\n  const showOverview = useCallback(e => {\n    setDrawerOpen(false);\n    history.push('/');\n  }, [history]);\n\n  const showAdmin = useCallback(e => {\n    setDrawerOpen(false);\n    history.push('/admin');\n  }, [history]);\n\n  const showAPDU = useCallback(e => {\n    setDrawerOpen(false);\n    history.push('/apdu');\n  }, [history]);\n\n  const showOATH = useCallback(e => {\n    setDrawerOpen(false);\n    history.push('/oath');\n  }, [history]);\n\n  return (\n    <div className={classes.root}>\n      <AppBar position=\"static\">\n        <Toolbar>\n          <IconButton edge=\"start\" color=\"inherit\" aria-label=\"menu\" onClick={() => setDrawerOpen(true)}>\n            <MenuIcon/>\n          </IconButton>\n          <Typography variant=\"h6\" className={classes.title}>\n            CanoKey Web Console\n          </Typography>\n          {\n            device ?\n              <Button variant=\"contained\" onClick={() => dispatch(disconnect())}>\n                Disconnect\n              </Button> :\n              <Button variant=\"contained\" onClick={() => dispatch(connect())}>\n                Connect\n              </Button>\n          }\n        </Toolbar>\n      </AppBar>\n      <Drawer\n        open={drawerOpen}\n        onClose={() => setDrawerOpen(false)}>\n        <img src={logo} alt=\"logo\" className={classes.icon}/>\n        <List>\n          <Divider/>\n          <ListItem button onClick={showOverview}>\n            <ListItemIcon><HomeIcon/></ListItemIcon>\n            <ListItemText>Overview</ListItemText>\n          </ListItem>\n          <ListItem button onClick={() => setAppletOpen(!appletOpen)}>\n            <ListItemIcon><AppsIcon/></ListItemIcon>\n            <ListItemText>Applets</ListItemText>\n            {appletOpen ? <ExpandLessIcon/> : <ExpandMoreIcon/>}\n          </ListItem>\n          <Collapse in={appletOpen}>\n            <List>\n              <ListItem button onClick={showAdmin} className={classes.nested}>\n                <ListItemIcon><ArrowForwardIcon/></ListItemIcon>\n                <ListItemText>Admin</ListItemText>\n              </ListItem>\n              <ListItem button onClick={showOATH} className={classes.nested}>\n                <ListItemIcon><ArrowForwardIcon/></ListItemIcon>\n                <ListItemText>OATH</ListItemText>\n              </ListItem>\n              <ListItem button className={classes.nested}>\n                <ListItemIcon><ArrowForwardIcon/></ListItemIcon>\n                <ListItemText>OpenPGP</ListItemText>\n              </ListItem>\n              <ListItem button className={classes.nested}>\n                <ListItemIcon><ArrowForwardIcon/></ListItemIcon>\n                <ListItemText>PIV</ListItemText>\n              </ListItem>\n            </List>\n          </Collapse>\n          <ListItem button onClick={showAPDU}>\n            <ListItemIcon><SyncAltIcon/></ListItemIcon>\n            <ListItemText>APDU Console & History</ListItemText>\n          </ListItem>\n        </List>\n      </Drawer>\n\n      <Switch>\n        <Route path=\"/\" exact component={Overview}/>\n        <Route path=\"/admin\" exact component={Admin}/>\n        <Route path=\"/apdu\" exact component={Apdu}/>\n        <Route path=\"/oath\" exact component={Oath}/>\n      </Switch>\n    </div>\n  );\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { TYPES } from \"./actions\";\nimport { List } from 'immutable';\n\nexport function device(state = null, action) {\n    if (action.type === TYPES.SET_DEVICE) {\n        if (state !== null) {\n            state.close();\n        }\n        return action.device;\n    }\n    return state;\n}\n\nexport function apduLog(state = List(), action) {\n    if (action.type === TYPES.APPEND_APDU_LOG) {\n        return state.push({\n            capdu: action.capdu,\n            rapdu: action.rapdu\n        });\n    }\n    return state;\n}\n\nexport function adminAuthenticated(state = false, action) {\n    if (action.type === TYPES.SET_ADMIN_AUTHENTICATED) {\n      return action.adminAuthenticated;\n    }\n    return state;\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport thunk from 'redux-thunk';\nimport logger from 'redux-logger';\nimport {createStore, combineReducers, applyMiddleware} from 'redux';\nimport {Provider} from 'react-redux';\nimport * as reducers from './reducers';\nimport {BrowserRouter} from 'react-router-dom';\nimport {SnackbarProvider} from 'notistack';\nimport Button from \"@material-ui/core/Button\";\n\nlet middleware = [thunk];\nif (process.env.NODE_ENV !== 'production') {\n  middleware = [...middleware, logger];\n}\nconst store = createStore(combineReducers(reducers), applyMiddleware(...middleware));\n\nconst notistackRef = React.createRef();\nconst onClickDismiss = key => () => {\n  notistackRef.current.closeSnackbar(key);\n}\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <BrowserRouter basename={process.env.PUBLIC_URL}>\n        <SnackbarProvider\n          maxSnack={3} ref={notistackRef}\n          action={(key) => (\n            <Button onClick={onClickDismiss(key)}>\n              Dismiss\n            </Button>\n          )}>\n          <App/>\n        </SnackbarProvider>\n      </BrowserRouter>\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = \"data:image/png;base64,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\""],"sourceRoot":""}